# Amadey-Analysis-Scripts

- ```decodeCipher.py``` scripti ile MD5 <em>"77e0a0a90e0231493bd421f4cdab0668"</em> hash değerine sahip Amadey zararlısının şifrelediği metin değerlerinin orijinal *Base64* haline çözülmektedir.

- ```idaScript.txt``` metin dosyasındaki bulunan IdaPython scripti ise *data section'ı* içerisinden şifrelenmiş değerlerin hepsini ele aldıktan sonra çözüp Base64 değerleri bir metin dosyasına yazdırmaktadır.

## Kullanım 

- ```decodeCipher.py``` parametre olarak verilen metin dosyasının içindeki değerleri çözmektedir. 
- ```idaScript.txt``` zararlı IDA'ya yüklendikten sonra altta bulunan Python alanında çalıştırıldığı takdirde şifreli değerleri metin dosyasına çözülmüş halde yazmaktadır.


## Decrypt Edilen Log Örneği

```
NjIuMjA0LjQxLjI3
LzlkalpkajA5L2luZGV4LnBocA
My42Ng
NWViNmI5NjczNA
bmJ2ZWVrLmV4ZQ
U0NIVEFTS1M
L0NyZWF0ZSAvU0MgTUlOVVRFIC9NTyAxIC9UTiA
IC9UUiAi
IiAvRg
U09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cUnVuT25jZQ
U09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cRXhwbG9yZXJcVXNlciBTaGVsbCBGb2xkZXJz
U3RhcnR1cA
UmVt
Y21kIC9DIFJNRElSIC9zL3Eg
U09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cUnVu
cnVuZGxsMzIg
IC9EZWxldGUgL1ROICI
UHJvZ3JhbXM
U09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cRXhwbG9yZXJcU2hlbGwgRm9sZGVycw
JVVTRVJQUk9GSUxFJQ
XEFwcA
UE9TVA
R0VU
aWQ9
JnZzPQ
JnNkPQ
Jm9zPQ
JmJpPQ
JmFyPQ
JnBjPQ
JnVuPQ
JmRtPQ
JmF2PQ
Jmx2PQ
Jm9nPQ
Y3JlZC5kbGx8Y2xpcC5kbGx8
ZDE
ZTE
ZTA
TWFpbg
aHR0cDovLw
aHR0cHM6Ly8
ZXhl
ZGxs
Y21k
cHMx
PGM
PGQ
UGx1Z2lucy8
Kysr
Iw
fA
JnVuaXQ9
PQ
c2hlbGwzMi5kbGw
a2VybmVsMzIuZGxs
R2V0TmF0aXZlU3lzdGVtSW5mbw
UHJvZ3JhbURhdGFc

QVZBU1QgU29mdHdhcmU
QXZpcmE
S2FzcGVyc2t5IExhYg
RVNFVA
UGFuZGEgU2VjdXJpdHk
RG9jdG9yIFdlYg
QVZH
MzYwVG90YWxTZWN1cml0eQ
Qml0ZGVmZW5kZXI
Tm9ydG9u
U29waG9z
Q29tb2R
V2luRGVmZW5kZXI
MDEyMzQ1Njc4OQ
cmI
d2I
Q29udGVudC1UeXBlOiBtdWx0aXBhcnQvZm9ybS1kYXRhOyBib3VuZGFyeT0tLS0t
DQpDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9ImRhdGEiOyBmaWxlbmFtZT0i
LS0tLS0t
Ig0KQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW0NCg0K
DQotLS0tLS0
LS0NCg
P3Njcj0x
LmpwZw
Q29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ
U1lTVEVNXEN1cnJlbnRDb250cm9sU2V0XENvbnRyb2xcQ29tcHV0ZXJOYW1lXENvbXB1dGVyTmFtZQ
Q29tcHV0ZXJOYW1l
YWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5LV8
LXVuaWNvZGUt
U1lTVEVNXEN1cnJlbnRDb250cm9sU2V0XENvbnRyb2xcVW5pdGVkVmlkZW9cQ09OVFJPTFxWSURFT1w
U1lTVEVNXENvbnRyb2xTZXQwMDFcU2VydmljZXNcQmFzaWNEaXNwbGF5XFZpZGVv
VmlkZW9JRA
XDAwMDA
RGVmYXVsdFNldHRpbmdzLlhSZXNvbHV0aW9u
RGVmYXVsdFNldHRpbmdzLllSZXNvbHV0aW9u
U09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3MgTlRcQ3VycmVudFZlcnNpb24
UHJvZHVjdE5hbWU
MjAxOQ
MjAyMg
MjAxNg
Q3VycmVudEJ1aWxk
JiY
ZWNobyBZfENBQ0xTICI
IiAvUCAi
Ok4i
Q0FDTFMgIg
OlIiIC9F
OkYiIC9F
JiZFeGl0
Li5c
XA
Ojo6
cnVuZGxsMzIuZXhl
L2sg
InRhc2traWxsIC9mIC9pbSAi
IiAmJiB0aW1lb3V0IDEgJiYgZGVsIA
JiYgRXhpdCI
IiAmJiByZW4g
ICYmIA
UG93ZXJzaGVsbC5leGU
LWV4ZWN1dGlvbnBvbGljeSByZW1vdGVzaWduZWQgLUZpbGUgIg
Ig
```

## Base64 Encoded

```
62.204.41.27
/9djZdj09/index.php
3.66
5eb6b96734
nbveek.exe
SCHTASKS
/Create /SC MINUTE /MO 1 /TN 
 /TR "
" /F
SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce
SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders
Startup
Rem
cmd /C RMDIR /s/q 
SOFTWARE\Microsoft\Windows\CurrentVersion\Run
rundll32 
 /Delete /TN "
Programs
SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders
%USERPROFILE%
\App
POST
GET
id=
&vs=
&sd=
&os=
&bi=
&ar=
&pc=
&un=
&dm=
&av=
&lv=
&og=
cred.dll|clip.dll|
d1
e1
e0
Main
http://
https://
exe
dll
cmd
ps1
<c
<d
Plugins/
+++
#
|
&unit=
=
shell32.dll
kernel32.dll
GetNativeSystemInfo
ProgramData\
AVAST Software
Avira
Kaspersky Lab
ESET
Panda Security
Doctor Web
AVG
360TotalSecurity
Bitdefender
Norton
Sophos
Comod
WinDefender
0123456789
rb
wb
Content-Type: multipart/form-data; boundary=----

Content-Disposition: form-data; name="data"; filename="
------
"
Content-Type: application/octet-stream



------
--

?scr=1
.jpg
Content-Type: application/x-www-form-urlencoded
SYSTEM\CurrentControlSet\Control\ComputerName\ComputerName
ComputerName
abcdefghijklmnopqrstuvwxyz0123456789-_
-unicode-
SYSTEM\CurrentControlSet\Control\UnitedVideo\CONTROL\VIDEO\
SYSTEM\ControlSet001\Services\BasicDisplay\Video
VideoID
\0000
DefaultSettings.XResolution
DefaultSettings.YResolution
SOFTWARE\Microsoft\Windows NT\CurrentVersion
ProductName
2019
2022
2016
CurrentBuild
&&
echo Y|CACLS "
" /P "
:N"
CACLS "
:R" /E
:F" /E
&&Exit
..\
\
:::
rundll32.exe
/k 
"taskkill /f /im "
" && timeout 1 && del 
&& Exit"
" && ren 
 && 
Powershell.exe
-executionpolicy remotesigned -File "
"

```

## Şifreli Metinler

```
KdxwH F5HlVzElz0
Itam6bup7lF7E4crZKK0Dowqgw==
JsT4I7==
KQKkIcN JlhBGC==
9gy4UM0wHo06SS==
RUCKQuKYO3R=
IUCAUMK5VUFxN2DdTYaKNWMHMyZJKABAFwYWO9F=
FwYWP9Fn
FcpxM7==
RUYIQviGQm0eMYcgcqYv43U21B4l3oSyaXCeLT0D9o0w7HQicrCl430eYjLqK46mWK==
RUYIQviGQm0eMYcgcqYv43U21B4l3oSyaXCeLT0D9o0w7HQicrCl430eVT8s3I BWRyeQNSq9kGV4IMpbGqC43sm3Tzv
RXGj8dW69C==
RgKv
VWQmDsdIEHOPKGcPIGYvD4zi
RUYIQviGQm0eMYcgcqYv43U21B4l3oSyaXCeLT0D9o0w7HQicrCl430eYjLq
 hKwUwCxIBNi
FwYGUMCq IZiE3ILIGx=
RByxUTOm8ZR=
RUYIQviGQm0eMYcgcqYv43U21B4l3oSyaXCeLT0D9o0w7HQicrCl430eVT8s3I BWRyePSmq8IBiKo0pZKKu5x==
GPKVMLOVQmdILWoCJU==
Uyuy8q==
RyYVQq==
OUKW
8QFa
GhOBKG==
GhCmKG==
GgYBKG==
GgyrKG==
GguAKG==
GhqlKG==
GhKwKG==
GgGvKG==
Ggu4KG==
Ggm4KG==
GgYpKG==
VXynUs p8IC R4omcGUg4Hs 
Wxt=
WNt=
WNp=
QQur77==
8BG28ttAHy==
8BG28xRaHAc=
WR7n
WAmu
VWQm
 BBz
MAB
MAF
RAm3USqz9Ac=
Hsht
Fq==
cu==
GhKw6NVd
MK==
 W7n7wBEIk m5In=
8WKA7c0xIBNwSIop
OWK2OcK57Z4nN5cwdKKpKX0ofs==
RByxUTOm8WWj7Iw 
NPODPRVlQ4do7J5ecqJ=
NROr8cJ=
PWuB8w0D94y7BGoeYk==
OPCHQq==
RAuwUwJlQ40l7ZAmdL =
OAYl9wdDEHinRi==
NPOJ
JtNyQwd5UYCVSYEYcqaW7R==
Nga2Uw0rVY mSZz=
QgYA9wdz
RWYy6wdE
NWYv7SW
SWawMw0rVY mSZz=
JxtAHpV6Jlh6HS==
 gx=
aWx=
NWYw9w0z E6W8ZsiOmqp6Xs2eTrd4pRyWgYA7I6pUZWjHAsfb7KqRHAAiPQpCU1w
AKeF7S 5VY 2EWImc7qr53g2eSZqFkCp9XyvGMWm IJ9BIWeb0J5AnMjhCueFACp8Qmn7cKyVV5k
IMPvGI5y
FaPMLSdz I0w7ESRe1qhGjwjgDro2YOkaAax79dAU5Wn7ESwdLyhQXVPGcQG
AKdvGI5yHU5=
IMPPx7==
MXCl8 5C
IgeyUm==
NWYw9w0z E6W8ZsiOmqd5IwueSDd5Imy9cY6GNi8 A6o55AqL1Ku4HQw2YZgQYR=
RVaVQu0STGS36pAibrGz4302giZoL4W3UyCx7dWD84CeJ40qcLKWRYEQ2SRhOGOy9Rq39w0DPoKvSS==
NWYv8x05VZOQRYSi
VQylUw0rV4mr4okpb0Ur5IAAgZHX5pe7bRdyHJNEJFZ4GB82LZX=
IRKw6MSAVIZv
RVaVQu0STGS36pAibrGz4302giZoL4W3UyCx7dWD84CeOYWmdKKgNngm3SZ9H2 RSzyROvC1OWWHM3n=
RVaVQu0STGSx5pIvb6mPRYLyQzv9L4WBagalUNShMoKB4YEBa1Cs4HA71BPlQIWy
SgamUMdONC==
UxpyHtF=
OAKoTN0x HSn7JImbq3vDmcU3TDr3JW38QYw
OAKoTN0x HSn7JImbq3vDmgU3TDr3JW38QYw
RUYIQviGQm0eMYcgcqYv43U21B4l3oSyaXBiObWhM50A6oMrdJOh5oIrfYU=
RByxUx0o G j5YL=
JdpzJG==
JdpAH7==
JdpzI7==
NXKA8c0z GO34Yoh
GcN=
WQCq7oG4bGSDJ2oQIGx=
FcpxPsFn
LeTk
NUuFOvRlEi==
LfxkDsdK
LeNkDsdK
GcOH wq5
IcUe
Uu==
Ldd8
 hKwUwCxIBNwSZ9i
IWhi
FhGj8Syw7YCuBE0jIGYl4Tvk
FcpoE9G57Y6n55MXIHtcBjTi3CLozC==
GcNiMNmu EN=
FcpoE9GDVY9i
FwNoDq==
RAY5UNOE7I0u5EWieKJ=
IQK6UMS6 Iqx5pssbKaf7TwA3SRr5IWC8Q3wUMVlHW4r5ILdIk==
Fa==
```
